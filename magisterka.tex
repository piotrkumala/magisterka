\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{indentfirst}
\usepackage{etoolbox}
\usepackage{placeins}
\usepackage{subcaption}
\usepackage{gensymb}
\usepackage{siunitx}
\usepackage{svg}
\usepackage[hidelinks]{hyperref}

\usepackage[style=ieee, backend=bibtex ,sorting=none]{biblatex}
\addbibresource{refs.bib}
%opening
\author{Piotr Kumala}
\title{Zastosowanie rekurencyjnych sieci neuronowych do predykcji szeregów czasowych}
\date{}
\graphicspath{ {./img/} }
\renewcommand*\contentsname{Spis treści}
\renewcommand*\figurename{Rysunek}
\renewcommand*\tablename{Tabela}
\renewcommand*\tableautorefname{Tab.}
\renewcommand*\figureautorefname{Rys.}



\begin{document}
\begin{titlepage}
	\begin{center}
		\includegraphics[width=0.4\textwidth]{img/university.jpg}
		\vspace*{1cm}
		
		{\Huge
			\textbf{Praca magisterska} \\
			
		}
		\vspace{0.5cm}
		{\Large
			Zastosowanie rekurencyjnych sieci neuronowych do predykcji szeregów czasowych
			
			\vspace{1cm}
			
			\textbf{Piotr Kumala} \\
		}
		\vspace{0.5cm}
		kierunek studiów: \textbf{Informatyka Stosowana} \\
		
		\vspace{1cm}
		
		{\Large Opiekun: \textbf{dr hab. inż. Piotr A. Kowalski}}
		\vfill
		
		\
		\vspace{0.8cm}
		
		
		Wydział Fizyki i Informatyki Stosowanej\\
		Akademia Górniczo-Hutnicza im. Stanisława Staszica\\
		Kraków, lipiec 2021r.
		
	\end{center}
\end{titlepage}
\pagenumbering{gobble}
\newpage
\begin{center}
	\textbf{Oświadczenie studenta}
\end{center}

Uprzedzony o odpowiedzialności karnej na podstawie art. 115 ust. 1 i 2 ustawy z dnia
4 lutego 1994 r. o prawie autorskim i prawach pokrewnych (t.j. Dz. U. z 2018 r. poz. 1191 z
późn. zm.): „Kto przywłaszcza sobie autorstwo albo wprowadza w błąd, co do autorstwa całości
lub części cudzego utworu albo artystycznego wykonania, podlega grzywnie, karze
ograniczenia wolności albo pozbawienia wolności do lat 3. Tej samej karze podlega, kto
rozpowszechnia bez podania nazwiska lub pseudonimu twórcy cudzy utwór w wersji
oryginalnej albo w postaci opracowania, artystyczne wykonanie albo publicznie zniekształca
taki utwór, artystyczne wykonanie, fonogram, wideogram lub nadanie.”, a także uprzedzony o
odpowiedzialności dyscyplinarnej na podstawie art. 307 ust. 1 ustawy z dnia 20 lipca 2018r.
Prawo o szkolnictwie wyższym i nauce (Dz. U. z 2018 r. poz. 1668 z późn. zm.) „Student
podlega odpowiedzialności dyscyplinarnej za naruszenie przepisów obowiązujących w uczelni
oraz za czyn uchybiający godności studenta.”, oświadczam, że niniejszą pracę dyplomową
wykonałem osobiście i samodzielnie i nie korzystałem ze źródeł innych niż wymienione w
pracy. 

Jednocześnie Uczelnia informuję, że zgodnie z art. 15a ww. ustawy o prawie autorskim
i prawach pokrewnych Uczelni przysługuje pierwszeństwo w opublikowaniu pracy
dyplomowej studenta. Jeżeli Uczelnia nie opublikowała pracy dyplomowej w terminie 6
miesięcy od dnia jej obrony, autor może ją opublikować chyba, że praca jest częścią utworu
zbiorowego. Ponadto Uczelnia, jako podmiot, o którym mowa w art. 7 ust. 1 pkt 1 ustawy z
dnia 20 lipca 2018 r. — Prawo o szkolnictwie wyższym i nauce (Dz. U. z 2018 r. poz. 1668 z
późn. zm.), może korzystać bez wynagrodzenia i bez konieczności uzyskania zgody autora z
utworu stworzonego przez studenta w wyniku wykonywania obowiązków związanych z
odbywaniem studiów, udostępnić utwór ministrowi właściwemu do spraw szkolnictwa
wyższego i nauki oraz korzystać z utworów znajdujących się w prowadzonych przez niego
bazach danych, w celu sprawdzania z wykorzystaniem systemu antyplagiatowego. Minister
właściwy do spraw szkolnictwa wyższego i nauki może korzystać z prac dyplomowych
znajdujących się w prowadzonych przez niego bazach danych w zakresie niezbędnym do
zapewnienia prawidłowego utrzymania i rozwoju tych baz oraz współpracujących z nimi
systemów informatycznych.

\vfill
\
\begin{flushright}
	............................................................... \\
	(czytelny podpis)
\end{flushright}

\newpage
\pagenumbering{arabic}
\tableofcontents
\newpage

\section{Wprowadzenie i cel pracy}

\subsection{Wprowadzenie}
Sieci neuronowe są coraz powszechniej używane do rozwiązywania wielu problemów życia codziennego. Nawet w wydawałoby się prostych urządzeniach jak telefony komórkowe zawierane są układy elektroniczne specjalizujące się w obliczeniach korzystających z sieci neuronowych \cite{appleNeuralEngine}. Taki rozwój technologiczny może zostać zastosowany do próby zrozumienia i szukania rozwiązań problemów życia codziennego. Jednym z szeroko występujących w świadomości społecznej problemów jest poziom zanieczyszczenia środowiska naturalnego i zmiany klimatu. Co roku na początku zimy media raportują o wysokim poziome zanieczyszczeń powietrza w polskich miastach. Podejmowane są również działania mające na celu ograniczenie poziomu tychże zanieczyszczeń przez samorządy i instytucje centralne. Posiadanie wiarygodnych estymacji skali problemu i jego zmiany w czasie może mieć wymierne skutki w usprawnianiu reakcji na wysokie poziomy zanieczyszczeń. W tej pracy podjęta zostanie próba stworzenia wiarygodnego modelu predykcyjnego poziomu zanieczyszczeń korzystającego z rekurencyjnych sieci neuronowych.

\subsection{Cel pracy}
Rekurencyjne sieci neuronowe są szeroko wykorzystywane i rozwijane przez największe firmy technologiczne. Są one stosowane między innymi do rozpoznawania pisma odręcznego i tekstu dyktowanego (Google Android LSTM). Mając na uwadze ilość wysiłku wkładanego w ulepszanie tychże sieci nasuwa się pytanie jakie rezultaty będą one osiągać w innych zastosowaniach. W ramach tej pracy zbadana zostanie jakość predykcji szeregów czasowych płynących z modeli opartych na rekurencyjnych sieciach neuronowych. Zostaną one zestawione z klasycznymi metodami predykcyjnymi w celu stwierdzenia zasadności stosowania sieci neuronowych. Specjalna uwaga zostanie również poświęcona różnicom w jakości uzyskiwanych rozwiązań różnych architektur sieci oraz skalowalności modeli opartych na rekurencyjnych sieciach neuronowych. 

\section{Wstęp teoretyczny}
\subsection{Szereg czasowy}
W ramach pracy podejmowane będą próby predykcji szeregu czasowego. Przed rozpoczęciem dalszych dywagacji należy zdefiniować samo pojęcie aby uniknąć nieścisłości. Podążając za Głównym Urzędem Statystycznym szeregiem czasowym nazywamy ciąg obserwacji ilustrujący kształt zjawiska w kolejnych okresach czasu. Obserwacją można określić zbiór cech opisujących zjawisko w danym punkcie czasu. Rozumiejąc w taki sposób pojęcie szeregu czasowego można w prosty sposób określić cel systemu predykcyjnego. System ten powinien być w stanie przewidzieć wartość pewnej cechy w kolejnym punkcie czasu na podstawie poprzednich obserwacji. Można również określić, że predykcja będzie tym lepsza im bardziej zgodna z posiadanymi obserwacjami. 

\subsection{Regresja liniowa}
Jedną z najbardziej klasycznych metod predykcyjnych jest regresja liniowa. Jej podstawy zostały położone w pracach Legrende'a i Gauss'a na początku XIX wieku \cite{seal1967studies}. Polega ona na dopasowywaniu funkcji liniowej do danych w taki sposób, aby jak najlepiej opisywała ona kształt i właściwości danych. Najprostszym mechanizmem służącym do zapewnienia optymalnych wyników jest metoda najmniejszych kwadratów opisana po raz pierwszy przez Legrende'a w 1805 roku\cite{legendre1806nouvelles}. Polega ona na takim dopasowywaniu parametrów funkcji aby zminimalizować sumaryczny kwadrat odległości obserwacji od prostej opisanej funkcją. 
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.2]{example_linear_regression.png}}
	\caption{Przykład wyniku regresji liniowej}
\end{figure}
\FloatBarrier
Metoda ta jest szeroko wykorzystywana, ale nie jest pozbawiona wad. Bardzo mocno reaguje ona na elementy nietypowe co może prowadzić do nieprawidłowego kształtu funkcji. F. Anscombe  w 1973 roku zaprezentował cztery zbiory danych, które korzystając z metody najmniejszych kwadratów zwracają takie same proste pomimo tego, że kształty tychże zbiorów danych są bardzo od siebie różne \cite{anscombe1973graphs}.
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.6]{anscombe.png}}
	\caption{Zbiory opisane przez Anscombe'ego i dopasowane do nich proste}
\end{figure}
\FloatBarrier 
\subsection{Drzewa decyzyjne}
Jedną z najszerzej używanych metod uczenia maszynowego są drzewa decyzyjne. Są one szeroko wykorzystywane ze względu na swoje nieskomplikowanie i intuicyjność w zrozumieniu wyników \cite{wu2008top}. Drzewem decyzyjnym nazywamy model predykcyjny, $h: X \rightarrow Y$, który przewiduje wartość $Y$ dla $x$ poprzez trawers drzewa od korzenia do liścia. Na każdym węźle drzewa kierunek przejścia jest wybierany poprzez rozdzielenie przestrzeni wejściowej. Najczęściej jest ono dokonywane na podstawie cech obserwacji $x$ \cite{books/daglib/0033642}. Wynikiem procesu uczenia jest drzewo pozwalające prześledzić ścieżkę jaką podąża każda obserwacja $x$ w celu przypisania jej odpowiedniej wartości. Przykładowe, bardzo uproszczone drzewo decyzyjne jest przedstawione na rysunku numer 3.
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.8]{example_decission_tree.png}}
	\caption{Przykładowe drzewo decyzyjne}
\end{figure}
\FloatBarrier

Na podstawie tego przykładu można łatwo zaobserwować główną zaletę drzew decyzyjnych, mianowicie łatwość interpretacji uzyskanego drzewa. Podejmowanie decyzji poprzez odpowiadanie na pytania, które stale zawężają możliwe rozwiązania jest intuicyjnie zrozumiałe. Powodem tej łatwości zrozumienia może być bliskość procesu wyboru przez drzewo do ludzkiego procesu podejmowania decyzji. Niektórzy ludzie twierdzą, że drzewo decyzyjne powiela ludzkie schematy myślowe \cite{James2013}. 

Drzewa decyzyjne mogą być wykorzystywane w problemach regresyjnych to znaczy dla ciągłej dziedziny rozwiązań $Y$. Należy jednak pamiętać, że w takim przypadku  należy uważać na możliwość zbytniego dopasowywania drzewa do danych trenujących. Problem ten objawia się stworzeniem zbyt szczegółowego drzewa, które nie generalizuje odpowiednio danych nieobecnych w zbiorze treningowym.

\subsection{Rekurencyjne sieci neuronowe}
Rekurencyjne sieci neuronowe to sieci neuronowe posiadające pętlę sprzężenia zwrotnego w swojej warstwie rekurencyjnej. Taka struktura pozwala im ,,zapamiętywać'' informacje przez pewien okres czasu i wykorzystywać w dalszych predykcjach \cite{reviewOfANN2018}. Taka umiejętność pozwala przewidywać, że rekurencyjna sieć neuronowa powinna dobrze zachowywać się w predykcji szeregu czasowego dzięki ,,zapamiętywaniu'' wartości w poprzednich krokach czasowych. 

Podwaliny rekurencyjnych sieci neuronowych zostały stworzone w 1986 roku przez D. Rumelhart'a. Opisywał on sposób uczenia sieci neuronowych poprzez propagację wsteczną błędu \cite{rumelhart1986learning}. Zauważył on, że korzystając z tej metody uczenia można wypracować sieć, która rekurencyjnie wyznaczy wartości wag neuronów w swojej warstwie ukrytej. Potrzeba opracowania nowego sposobu uczenia wynikała z istnienia zadań niedających się rozwiązać poprzez proste połączenie jednostek wejściowych z wyjściowymi.

Powszechnym sposobem myślenia o strukturze sieci neuronowych jest seria warstw składających się na sieć. Każda warstwa składająca się z pewnej liczby neuronów komunikuje się z następującą warstwą aż do osiągnięcia warstwy wyjściowej zwracającej wynik sieci. 
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.3]{ann_layers.png}}
	\caption{Przykładowa sieć neuronowa z trzema warstwami}
\end{figure}
\FloatBarrier

W przypadku sieci rekurencyjnej nie jest tworzona seria warstw komunikujących się ze sobą, a jedna rekurencyjna warstwa zmieniająca się w czasie. W celu lepszego zrozumienia struktury i sposobu działania takiej sieci często dokonywany jest proces rozwijania w czasie warstwy rekurencyjnej.

\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.3]{Recurrent_neural_network_unfold.png}}
	\caption{Przykład rozwijania warstwy rekurencyjnej $h$}
\end{figure}
\FloatBarrier

W powyższym przykładzie należy zauważyć, że w wersji rozwiniętej $h_{t-1}, h_t i h_{t+1}$ nie są osobnymi warstwami, a jedynie reprezentacją warstwy $h$ w różnych krokach czasowych. 

Na przestrzeni lat powstało wiele wariacji na temat architektury rekurencyjnych sieci neuronowych odpowiadających na różne problemy i wymagania im stawiane. W dalszym ciągu pracy przedstawione zostaną wybrane architektury, które mogą zostać wykorzystane do rozwiązania postawionego problemu predykcji szeregu czasowego.


\subsection{Architektura LSTM}
Sieci Long Short-Term Memory(LSTM) powstały jako próba rozwiązania problemów występujących w klasycznych sieciach rekurencyjnych. Problemy te głównie dotyczyły aspektu rekurencyjnych sieci neuronowych pozwalającego ,,zapamiętać'' sieci poprzednie kroki czasowe. Zauważono, że korzystając z mechanizmu propagacji wstecznej przesyłany do następnych kroków czasowych sygnał błędu (sposób sieci na ,,zapamiętanie'' poprzednich przypadków) ma tendencję do znikania lub wybuchania. 

Zniknięciem sygnału błędu nazwać można sytuację, w której dąży on do zera w kolejnych krokach czasowych. Jest ona problemem w procesie uczenia, ponieważ może doprowadzić do bardzo dużego przedłużenia procesu lub nawet całkowicie uniemożliwić poprawne nauczenie sieci.

Wybuchem sygnału błędu nazywana jest sytuacja, w której dąży on do nieskończoności. Sytuacja ta jest niepożądana, ponieważ bardzo duży błąd przesyłany do następnych kroków czasowych oznacza, że sieć tak naprawdę niczego nie ,,zapamiętuje''. Może to prowadzić do oscylacji wag w sieci bez sygnału błędu stabilizującego wynik. 

Problemy te zostały podniesione przez S. Hochreiter'a w jego pracy doktorskiej, a następnie dokładniej opisane w roku 1991 we wspólnej pracy z J. Schmidhuber'em. 
W ramach artykułu ,,Long Short-Term Memory'' zaproponowali oni całkowicie nową architekturę rekurencyjnej sieci neuronowej dążącą do rozwiązania wyżej opisanych problemów \cite{hochreiter1997long}.

Stworzona została architektura oparta na komórkach pamięci i bramkach. Podstawową składową warstwy w tej architekturze jest komórka pamięci. Trzonem komórki jest rekurencyjna jednostka liniowa posiadająca Stałą Karuzelę Błędu (Constant Error Carousel), w skrócie CEC. Wartości CEC będą nazywane stanem komórki. Istnienie mechanizmu CEC eliminuje problemy z sygnałem błędu, ponieważ zapewnia on, że lokalny błąd nie będzie się samoistnie zmieniał w kolejnych krokach czasowych.

Mechanizmem odpowiedzialnym za modyfikację stanu komórki są bramki wejściowa i wyjściowa. Bramka wejściowa zajmuje się kontrolą przepływu nowych informacji do komórki. Oznacza to, że decyduje ona czy zachować obecny stan, czy nadpisać go nowymi informacjami. Można rozumieć zadanie bramki wejściowej jako określanie czy należy zapamiętać nową wiedzę lub uaktualnić istniejącą wiedzę. 

Bramka wyjściowa natomiast kontroluje przepływ stanu komórki na zewnątrz. Decyduje ona czy przechowywana przez komórkę wiedza jest warta przekazania innym komórkom do zapamiętania. Jej zadanie możemy rozumieć jako decyzję czy podzielić się swoją wiedzą z resztą komórek czy zachować ją dla siebie. 

\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{lstm_without_forget_gate_schema.png}}
	\caption{Komórka pamięci w architekturze LSTM}
\end{figure}
\FloatBarrier

Na powyższym rysunku przedstawiony jest schemat budowy najprostszej komórki pamięci w sieci LSTM. Wyraźnie widoczne są bramki wejściową i wyjściową operujące na sygnałach wejściowych $w_{in_ji}$, $y_{in_j}$, $net_{in_j}$ oraz wyjściowych ${w_{out_ji}}$, $y_{out_j}$, $net_{out_j}$. Widoczny jest również mechanizm zmiany stanu wewnętrznego komórki $s_{c_j}$ na podstawie przepuszczonego przez bramkę wejściową sygnału $y_{in_j}$.

Stworzona w taki sposób architektura okazała się mieć jeden poważny problem. Stan komórki wykazywał tendencje do liniowego wzrostu w kolejnych krokach czasowych. Wzrost ten mógł prowadzić do saturacji funkcji h. Saturacja ta prowadziła do przestania przyjmowania nowych błędów i zrównania wyniku komórki z wartością funkcji aktywacji bramki wyjściowej. W takich kierunkach komórka pamięci traciła swoje korzyści i wracała do zachowania typowego dla zwykłej sieci rekurencyjnej \cite{gers2000learning}.

Rozwiązaniem tego problemu okazało się dodanie trzeciej bramki nazywanej bramką zapominania. Zauważono, że przechowywanie w pamięci komórki danych przez bardzo długi często sprawia, że dane te są nieaktualne. Bramka zapominania kontroluje kiedy i ile przechowywanego stanu komórki $s_{c_j}$ należy zapomnieć. Dzięki usuwaniu z pamięci przestarzałych błędów wyeliminowany został problem saturacji funkcji h. Bramka zapominania stała się integralna częścią architektury LSTM. 

\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.9]{lstm_with_forget_gate_schema.png}}
	\caption{Komórka pamięci w architekturze LSTM z bramką zapominania}
\end{figure}
\FloatBarrier
\newpage
\subsection{Architektura GRU}

Architektura Gated Recurrent Unit (GRU) została zaproponowana przez K. Cho w 2014 roku \cite{https://doi.org/10.48550/arxiv.1406.1078}. Oryginalnie została zaprojektowana do pracy w sieciach typu enkoder-dekoder do tłumaczenia tekstu jako alternatywa dla używanych wcześniej komórek z funkcją aktywacji tangens hiperboliczny. Decyzja o próbie wykorzystania jednostki rekurencyjnej działającej na bramkach była motywowana sukcesem sieci LSTM.

W porównaniu do architektury Long Short-Term Memory Gated Recurrent Unit jest prostsza do zaimplementowania i mniej wymagająca obliczeniowo. Dzieje się tak dzięki zmniejszeniu ilości bramek kontrolujących pamięć komórki. Podczas gdy LSTM do poprawnego działania wymaga użycia trzech bramek (wejściowej, wyjściowej i zapominania) to wewnątrz jednostki GRU występują jedynie dwie bramki (aktualizacja i reset). 

\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=1]{gru_schema.png}}
	\caption{Komórka pamięci w architekturze GRU}
\end{figure}
\FloatBarrier

Na powyższym rysunku przedstawiony jest schemat komórki GRU, gdzie stan komórki w obecnym kroku czasowym $h$ zmienia się w $\widetilde{h}$. Widoczne są również bramki resetu $r$ i aktualizacji $z$. 

Bramka reset (reset gate) decyduje czy poprzedni wewnętrzny stan komórki powinien być zachowany czy wyrzucony. Jej wartość w j-tej komórce w warstwie wyznaczamy ze wzoru:
\begin{equation}
	r_j = \sigma([W_rx]_j + [U_rh_{t-1}]_j),
\end{equation} 
gdzie $W_r$ i $U_r$ to macierze wag, których wartości są wyznaczane w trakcie uczenia sieci. Przy takich założeniach można zauważyć, że jeżeli wartość bramki reset będzie bliska zeru to stan komórki będzie często usuwany.

Bramka aktualizacji (update gate) decyduje natomiast ile stanu z poprzedniego kroku czasowego należy zapamiętać w obecnym kroku. Wartość bramki w j-tej komórce warstwy wyznaczamy ze wzoru:
\begin{equation}
	z_j = \sigma([W_zx]_j + [U_zh_{t-1}]_j),
\end{equation} 
gdzie $W_z$ i $U_z$ to macierze wag analogiczne do tych występujących w bramce resetu. 

Wiedząc w jaki sposób zachowują się oba typy bramek oraz biorąc pod uwagę, że macierze $W_z, W_r, U_z, U_r$ są wyznaczane w trakcie uczenia można wysunąć kilka obserwacji. Dualizm bramek powinien prowadzić do jednej bramki będącej znacznie bardziej aktywnej od drugiej. Zjawisko to można rozumieć jako specjalizację komórek warstwy, gdzie te z aktywnymi bramkami resetu odpowiadają za pamięć krótkotrwałą, a te z aktywną bramką aktualizacji odpowiadają za pamięć długoterminową. Pamiętając, że aktywność każdej bramki jest dopasowywana dla każdej komórki w procesie uczenia możemy założyć, że podział komórek na pamięć krótkotrwałą i długotrwałą będzie w wytrenowanej sieci rozłożony w sposób optymalny. Rozumiemy przez to, że jeżeli dane treningowe na przykład nie wykazywały długofalowych trendów, a były bardziej chaotyczne i często zmieniające się to po procesie uczenia powinny dominować komórki z aktywną bramką resetu.
\subsection{Indeks Willmott'a}

\newpage
\section{Przygotowanie zbioru danych}
Odpowiednie dane są niezbędne do prób zbadania użyteczności rekurencyjnych sieci neuronowych do predykcji szeregów czasowych. Z tego powodu stworzeniu badawczo ciekawych szeregów czasowych przeznaczona została adekwatna ilość czasu. Przeanalizowano wiele możliwych zbiorów danych aby ich użyć do zbudowania szeregów czasowych. Ostatecznie podjęta została decyzja o połączeniu danych klimatycznych agregowanych przez Instytut Meteorologii i Gospodarki Wodnej oraz danych o zanieczyszczeniu powietrza zbieranych przez Główny Inspektorat Ochrony Środowiska. Oba te zbiory, sposób połączenia ich w szereg czasowy i napotkane trudności zostaną opisane w tym rozdziale. 

\subsection{Baza danych Instytutu Meteorologii i Gospodarki Wodnej}
Instytut Meteorologii i Gospodarki Wodnej to instytucja zajmująca się prognozowaniem pogody i sporządzaniem ekspertyz meteorologicznych. Cel ten jest realizowany między innymi poprzez przeprowadzanie systematycznych pomiarów i obserwacji korzystając z sieci stacji pomiarowych \cite{imgwTask}. Ten aspekt działalności Instytutu implikuje istnienie obszernej bazy danych pomiarowych, które są udostępniane publicznie ponieważ celem Instytutu jest służba społeczeństwu. Ten zbiór danych pomiarowych został wykorzystany do budowy szeregów czasowych. 

Publicznie dostępne są dane klimatyczne od 1951 roku do chwili obecnej. Są one udostępniane w formie dwóch plików csv dla każdego miesiąca roku. Dane w obu plikach mają analogiczną strukturę wyglądającą następująco:
\begin{center}
	\begin{tabular}{|c|c|c|c|c|c}
		Kod stacji & Nazwa stacji & Rok & Miesiąc & Dzień & Wyniki pomiarów...
	\end{tabular}
\end{center}
W kolejnych wierszach są zapisane informacje o pomiarach z jednej stacji z całego miesiąca, potem następnej i tak dalej. Ponieważ wyniki pomiarów z obu plików mogą nieść znaczenie w procesie predykcyjnym podjęta została decyzja o korzystaniu z danych zapisanych w obu plikach. Biorąc pod uwagę oba pliki w bazie danych agregowane są wyniki pomiarów: 
\begin{itemize}
	\item Średniej dobowej temperatury [$\degree C$]
	\item Średniej dobowej wilgotności względnej [\%]
	\item Średniej dobowej prędkości wiatru [$\frac{m}{s}$]
	\item Średniego dobowego zachmurzenia ogólne [oktany]
	\item Maksymalnej temperatury dobowej [$\degree C$]
	\item Minimalnej temperatury dobowej [$\degree C$]
	\item Temperatura minimalnej przy gruncie [$\degree C$]
	\item Suma dobowej opadów [$mm$]
	\item Rodzaju opadu [S (Śnieg) /W (Deszcz)]
	\item Wysokości pokrywy śnieżnej [$cm$]
\end{itemize}
Dla każdego pomiaru jest zapisywany status tego pomiaru pozwalający stwierdzić czy został on przeprowadzony poprawnie i czy dane zjawisko występowało w danym dniu. W wykorzystywanych danych z okresu 2001-2020 nie było przypadku błędnego pomiaru co pozwala wierzyć w dokładność danych i skrupulatność przeprowadzanych obserwacji. 

\subsection{Baza danych Głównego Inspektoratu Ochrony Środowiska}
Główny Inspektorat Ochrony Środowiska to instytucja powołana 27 kwietnia 2001 roku \cite{giosStart}. Jako część swojej misji określa ona mierzenie stanu środowiska oraz udostępnianie wyników tych pomiarów społeczeństwu \cite{giosMission}. Ten aspekt działalności Inspektoratu gwarantuje istnienie dużej bazy wyników pomiarów danych dotyczących poziomu zanieczyszczeń powietrza, które mogą zostać wykorzystane do tworzenia szeregów czasowych. 

Główny Inspektorat Ochrony Środowiska jest instytucją znacznie młodszą o Instytutu Meteorologii i Gospodarki Wodnej, więc dane agregowane przez Inspektorat nie będą dotyczyć tak długiego okresu czasu jak dane Instytutu. Jako że Główny Inspektorat Ochrony Środowiska jest instytucją względnie młodą to w jego początkowych stadiach nie monitorował on wielu różnych typów zanieczyszczeń oraz nie posiadał szerokiej sieci punktów pomiarowych. W trakcie jego rozwoju dochodziło również do zmian w formacie udostępnianych danych. Czynniki te musiały być brane pod uwagę w trakcie pracy z udostępnianymi przez niego danymi. 

Dane te są udostępniane w formie plików formatu xlsx, gdzie dla każdej substancji zanieczyszczającej tworzony jest osobny plik z wynikami pomiarów. Co do zasady struktura danych prezentuje się następująco:
\begin{center}
	\begin{tabular}{|c|c|c}
		Data wykonania pomiaru & Kod stacji 1 & Kod stacji 2 ...
	\end{tabular}
\end{center}
Różne czynniki zanieczyszczające mają również różne rozdzielczości czasowe, dla niektórych jest rozdzielczość godzinna, dla innych dobowa, dla niektórych są dostępne obie. 

Ilość badanych substancji zanieczyszczających powietrze fluktuuje w czasie. W pierwszym roku, dla którego dostępne są dane, mianowicie roku 2000 mierzone były:
\begin{itemize}
	\item Średnie dobowe stężenie Benzo(a)pirenu w pyle PM10
	\item Średnie dobowe stężenie Benzenu
	\item Średnie dobowe stężenie Kadmu w pyle PM10 
	\item Średnie dobowe stężenie Niklu w pyle PM10
	\item Godzinne stężenie Dwutlenku azotu
	\item Średnie dobowe stężenie Dwutlenku azotu
	\item Godzinne stężenie mieszaniny Tlenku azotu i Dwutlenku azotu
	\item Godzinne stężenie Ozonu
	\item Średnie dobowe stężenie pyłu PM10
	\item Godzinne stężenie Dwutlenku siarki
	\item Średnie dobowe stężenie Dwutlenku siarki
\end{itemize}
W kolejnych latach liczba badanych czynników zanieczyszczających oraz rozdzielczość czasowa tych badań znacząco wzrastała, jednak aby zachować możliwość budowy jak najdłuższego szeregu czasowego podjęta została decyzja na braniu pod uwagę jedynie polutantów występujących w wynikach pomiarów ze wszystkich lat działania Inspektoratu. 


Nie bez znaczenia jest również fakt, że ilość stacji badających różniła się znacznie pomiędzy różnymi substancjami. Ostatecznie wybrane zostało używanie jedynie średniego dobowego stężenia pyłu PM10, jako że był on badany przez największą ilość stacji przez najdłuższy możliwy czas. Czynniki te miały duży wpływ na proces budowania jednego szeregu czasowego na podstawie obu opisanych zbiorów danych, który zostanie opisany w dalszej części pracy.

\subsection{Tworzenie szeregów z obu źródeł danych}
Podjęta została decyzja o połączeniu obu źródeł danych w jeden szereg czasowy aby utworzony szereg był badawczo ciekawy. Celem tego działania było umożliwienie predykcji stężenia pyłu PM10 na podstawie danych klimatycznych, ponieważ zdaje się mieć to odzwierciedlenie w rzeczywistości.

Różnice w sieciach stacji pomiarowych Instytutu Meteorologii i Gospodarki Wodnej oraz Głównego Inspektoratu Ochrony Środowiska stanowiły poważny problem w próbie połączenia ich w jeden spójny szereg czasowy. Brak uwzględnienia tego ograniczenia doprowadziłby do całkowitego braku sensownego kontekstu geograficznego w otrzymanym szeregu czasowego. Problem ten został rozwiązany poprzez przygotowywanie osobnych szeregów czasowych dla wybranych stacji Instytutu i Inspektoratu o podobnym położeniu geograficznym. Sposób tworzenia takiego szeregu zostanie przedstawiony na podstawie Krakowa, następnie przedyskutowany zostanie problem tworzenia większej ilości takich szeregów. 

\subsubsection{Tworzenie szeregu dla Krakowa}
Stacja pomiarowa Instytutu Meteorologii i Gospodarki Wodnej w Krakowie posiada jedną stację pomiarową w Krakowie, której wyniki zostały ujęte w danych klimatycznych wykorzystywanych w tej pracy. Natomiast Główny Inspektorat Ochrony Środowiska w okresie będącym tematem zainteresowania tej pracy posiadał wiele różnych punktów pomiarowych w Krakowie. Punkty te często pojawiały się w środku okresu 2000-2020, zmieniały swoje położenie, przestawały prowadzić pomiary lub robiły przerwę w rejestrowaniu zanieczyszczeń na kilka lat. Z tego powodu nie można było skorzystać z wyników każdej ze stacji pomiarowych Instytutu jako zalążka szeregu czasowego bez jego niepotrzebnego skrócenia lub przerw utrudniających analizę. Dodatkowo ponieważ stacje GIOŚ znajdowały się w różnych częściach Krakowa zestawianie ich z jednym punktem pomiarowych IMGW prowadziłoby do szeregu niekoniecznie poprawnie osadzonego geograficznie. Warto również zauważyć, że niektóre stacje pomiarowe zanieczyszczenia powietrza były w obszarach z dużą ilością ruchu samochodowego, inne natomiast w obszarach ze zdecydowanie mniejszym poziomem ruchu samochodowego w okolicy. Takie rozłożenie punktów pomiarowych mogłoby sprawić, że szereg powstały na podstawie danych z jednej stacji IMGW i jednej stacji GIOŚ mógłby być niepoprawny. Jego niepoprawność łatwo zrozumieć na przykładzie, w którym do predykcji zanieczyszczenia nad bardzo ruchliwą ulicą korzystamy jedynie z danych klimatycznych z całkowicie innej części. Taka predykcja najpewniej byłaby wychwycić pewne trendy (np. ludzie częściej korzystający z samochodów w zimie), lecz nie byłyby to kompletne dane potrzebne do przewidywania. Pomijałoby to również wahania warunków pogodowych w różnych częściach miasta, które również mogą wpływać na zanieczyszczenie powietrza.

Aby rozwiązać powyższe problemy stworzony został szereg oparty na danych klimatycznych dostarczanych przez Instytut Meteorologii i Gospodarki Wodnej dla Krakowa oraz średnią arytmetyczną stężenia pyłu PM10 rejestrowanego przez punkty pomiarowe Głównego Inspektoratu Ochrony Środowiska znajdujące się w Krakowie. Takie podejście pozwoliło na stworzenie badawczo interesującego szeregu czasowego, który operował na średnich wartościach zanieczyszczeń w całym Krakowie bez przerw w pomiarach lub błędów. 
Operowanie na średnich wartościach zanieczyszczeń z dużych miast ma również dodatkową zaletę w eliminacji potrzeby troski o bardzo dokładne powody, dla których poziom zanieczyszczeń możne się różnić w takim miejscu. Jako takie powody można przedstawić między innymi: 
\begin{itemize}
	\item Poziom przewietrzania badanego obszaru (dostępność odpowiednich korytarzy powietrznych dla kierunku wiatru w danym dniu, wysokość zabudowy itd.)
	\item Poziom ruchu ulicznego w badanym obszarze (płynność ruchu, dostępność alternatywnych form komunikacji, itd.)
	\item Sposób ogrzewania budynków (dostępność sieci ciepłowniczej, poziom zamożności społeczności lokalnej, itd.)
\end{itemize}
Powodów takich można wymienić znacznie więcej, widzimy jednak, że nie wyeliminowanie potrzeby dbania o nie upraszcza dalsze rozważania. Jest to korzyścią zwłaszcza, celem tej nie jest pracy dokładna analiza powodów występowania zanieczyszczeń powietrza. Dbanie o dokładność szeregu służy tylko upewnieniu się, że przeprowadzane predykcje nie są całkowicie oderwane od rzeczywistości. 

\subsubsection{Tworzenie większej ilości szeregów}
Przy badaniu przydatności rekurencyjnych sieci neuronowych do predykcji czasowych należy skupić się również na potrzebie skalowalności uzyskanych modeli predykcyjnych. Nie ma żadnej gwarancji, że model predykcyjny uzyskujący zadowalające wyniki dla małych zbiorów danych utrzyma zadowalający poziom dokładności predykcji dla zdecydowanie większych zbiorów danych. Fakt ten dla szeregu utworzonego w poprzedniej sekcji oznacza potrzebę stworzenia innych szeregów geograficznych w celu lepszego zrozumienia użyteczności badanych modeli.

W tym celu zbudowane zostały szeregi czasowe dla każdej odpowiadającej sobie geograficznie i czasowo pary punktów pomiarowych z Instytutu Meteorologii i Gospodarki Wodnej oraz Głównego Inspektoratu Ochrony Środowiska. W przypadkach, gdzie występowały wiele punktów mierzących stężenie pyłu PM10 przeprowadzano uśrednianie wyników pomiarów analogicznie do przypadku krakowskiego. Mniejsza uwaga została również poświęcona potrzebie ciągłości szeregu, jako że braki w pewnym fragmencie czasu były ,,przykrywane'' przez inne szeregi. Korzystając z takiej metodologii sporządzone zostały szeregi dla wszystkich sensownych par punktów pomiarowych obu instytucji.

\section{Przeprowadzone badania}
W celu zbadania przydatności rekurencyjnych sieci neuronowych do predykcji szeregów czasowych zestawione ze sobą zostały jakości wyników różnych modeli predykcyjnych. Analizowano zarówno klasyczne metody predykcyjne jak i nowocześniejsze wykorzystujące sieci neuronowe. Celem takiego porównywania było wyłonienie najbardziej obiecującego badawczo modelu predykcyjnego w celu dalszej analizy jego wydajności. Dalsza analiza jego wydajności polegała na zbadaniu zmian zachowania modelu przy zwiększającej się ilości danych. 

W tym rozdziale przedstawiona zostanie metodologia obu etapów analizy przydatności rekurencyjnych sieci neuronowych do predykcji szeregów czasowych. 
\subsection{Porównanie wydajności modeli predykcyjnych}
Pierwszym stadium analizy było zbadanie różnych metod predykcji szeregów czasowych na przykładzie prostego szeregu czasowego. W tym etapie analizy jako zbiór danych wykorzystywany jest szereg zbudowany dla Krakowa, opisany w rozdziale \hyperlink{subsubsection.3.3.1}{3.3.1}. Celem tego procesu jest porównanie jakości wyników zwracanych przez modele oparte na rekurencyjnych sieciach neuronowych z klasycznymi metodami predykcji. Poszukiwana jest również najlepszy model rekurencyjny mogący zostać wykorzystany w dalszych badaniach. 

\subsubsection{Regresja liniowa}
Pierwszą metodą zastosowaną do predykcji była regresja liniowa, jako że jest ona jedną z najstarszych i dobrze przebadanych metod predykcyjnych. Jej wyniki pełniły w dalszych rozważaniach rolę grupy kontrolnej dla wyników uzyskiwanych przez inne metody.

Regresja liniowa została przeprowadzona korzystając z metod udostępnionych w ramach biblioteki ,,sklearn'' dla języka Python. Biblioteka ta udostępnia funkcjonalność przeprowadzenia prostej regresji liniowej metodą najmniejszych kwadratów \cite{sklearnLinearRegression}.

W celu poprawnego podziału danych na zbiór trenujący i testujący wykorzystana została metoda ,,train\_test\_split'' z tej samej biblioteki ,,sklearn''. Zdefiniowano tejże metodzie, że 20\% danych powinno stanowić zbiór testujący, a pozostałe dane powinny być użyte do trenowania modelu. 

W celu umożliwienia ewaluacji wyników działania metody sporządzony został wykres zestawiający przewidziane wartości z wynikami pomiarów oraz wyliczone zostało kilka charakterystyk pozwalających na porównanie. Charakterystyki te to:
\begin{center}
	\begin{itemize}
		\item Wynik testu $R^2$
		\item Błąd średniokwadratowy
		\item Pierwiastek błędu średniokwadratowego
		\item Wartość indeksu Willmott'a
	\end{itemize}
\end{center}

Uzyskane w tej metodzie wyniki zostaną dokładnie przedyskutowane w podsekcji \hyperlink{subsubsection.5.1.1}{5.1.1} oraz zestawione z wynikami pozostałych metod w podsekcji \hyperlink{subsubsection.5.1.6}{5.1.6}.

\subsubsection{Drzewa decyzyjne}
Drugą zastosowaną metodą była regresja z wykorzystaniem drzew decyzyjnych, jako że jest ona jedną z najszerzej wykorzystywanych metod uczenia maszynowego. Uzyskane przez nią wyniki będą pełnić rolę podobną do wyników regresji liniowej. Warty odnotowania jest również fakt użyteczności graficznych reprezentacji procesu decyzyjnego do zrozumienia nie tylko sposobu podejmowania decyzji, ale również struktury danych wejściowych. 

Regresja z wykorzystaniem drzew decyzyjnych została przeprowadzona za pomocą metod udostępnionych w bibliotece ,,sklearn'' dla języka Python. Biblioteka ta definiuje drzewa decyzyjne jako nieparametryczną metodę nadzorowanego uczenia używaną do klasyfikacji i regresji \cite{sklearnDecissionTrees}. Aspekt regresyjny został wykorzystany w prowadzonych badaniach. 

Zastosowany został podział na zbiór uczący i testujący analogicznie jak w przypadku regresji liniowej. Tak samo analogiczne podejście zostało przyjęte w liczeniu charakterystyk porównawczych wyników. Więcej szczegółów podziału i wyliczanych charakterystyk można znaleźć w podsekcji \hyperlink{subsubsection.4.1.1}{4.1.1}.

Dla ułatwienia zrozumienia otrzymywanych wyników sporządzony został również rysunek ostatecznego drzewa decyzyjnego. Rysunek ten został wykonany korzystając z języka opisu grafów DOT \cite{dotLanguage}.

Wyniki regresji z wykorzystaniem drzew decyzyjnych zostaną dokładnie przedstawione w podsekcji \hyperlink{5.1.2}{5.1.2} oraz porównane z wynikami innych metod w podsekcji \hyperlink{5.1.6}{5.1.6}.

\subsubsection{Sieci rekurencyjne}
W ramach badania przydatności rekurencyjnych sieci neuronowych do badania szeregów czasowych rozważane były trzy rodzaje architektury sieci neuronowej. Badano zachowanie prostej rekurencyjnej sieci neuronowej, sieci typu LSTM oraz GRU. Uzyskane w ten sposób wyniki zostaną przeanalizowane w kontekście przydatności tej metody oraz w kontekście jej wydajności w porównaniu do nowocześniejszych architektur sieci rekurencyjnych. 

Sieć neuronowa posiadała również proste warstwy wejściowe i wyjściowe wymagane do poprawnej pracy warstw ukrytych ze wykorzystywanym w badaniach zbiorem danych.
Dla każdej rozważanej architektury tworzona była warstwa ukryta na niej oparta dostarczana w ramach biblioteki ,,TensorFlow'' dla języka Python. Dla prostej sieci rekurencyjnej była to ,,SimpleRNN'' \cite{tfSimpleRNN}, dla sieci Long Short-Term Memory  warstwa ,,LSTM'' \cite{tfLSTM}, a dla sieci Gated Recurrent Unit warstwa ,,GRU'' \cite{tfGRU}.

Zastosowany został podział na zbiór uczący i testujący analogicznie jak w przypadku regresji liniowej. Tak samo analogiczne podejście zostało przyjęte w liczeniu charakterystyk porównawczych wyników. Więcej szczegółów podziału i wyliczanych charakterystyk można znaleźć w podsekcji \hyperlink{subsubsection.4.1.1}{4.1.1}.
Badany był również wpływ liczby neuronów w warstwie ukrytej na jakość uzyskiwanych wyników. 

Wyniki predykcji zostaną dokładnie przedstawione w podsekcjach odpowiadających każdej w zastosowanych architektur oraz porównane z wynikami innych metod w podsekcji \hyperlink{5.1.6}{5.1.6}.


\subsection{Badanie skalowalności modelu GRU}
Jak zauważono poprzednio skalowalność modelu ma duże znaczenie przy określaniu jego przydatności do predykcji szeregów czasowych. W celu zbadania skalowalności modelu opartego na architekturze Gated Recurrent Unit przeprowadzono serię uczenia i testowania dla szeregów czasowych o zwiększającej się liczbie elementów. 

Sieć neuronowa posiadała analogiczną budowę do sieci GRU opisanej w podsekcji \hyperlink{subsubsection.4.1.3}{4.1.3}. Występowały zmiany struktury warstwy wejściowej umożliwiające współpracę z różnymi wymiarami danych wejściowych.

W ramach badania przeprowadzone zostało łącznie dwadzieścia dziewięć procesów uczenia i walidacji stworzonego modelu. W każdym kolejnym kroku badania do wejściowego szeregu czasowego dodawany był nowy szereg czasowy dla położenia geograficznego nie ujętego w poprzednich danych. 

Przeprowadzone zostały identyczne pomiary wydajności modelu oraz wizualne zestawienia wyników predykcji z danymi rzeczywistymi. Sporządzony został również wykres wartości indeksu Willmott'a dla każdego przeprowadzonego procesu uczenia i walidacji modelu.

Przyjęcie takiej metodologii badania skalowalności pozwala wierzyć, że otrzymane wyniki będą pomocne w określeniu przydatności tejże sieci do predykcji szeregów czasowych. Wyniki te zostaną przedstawione w podsekcji \hyperlink{subsection.5.2}{5.2}.

\section{Otrzymane wyniki}
W ramach tego rozdziału przedstawione zostaną wyniki wszystkich przeprowadzonych badań. Zostanie również przeprowadzona analiza wyników każdej metody z osobna oraz analiza porównawcza wyników wielu metod. Celem tej analizy jest zapewnienie pełnego kontekstu niezbędnego do wyciągania wniosków, które zostaną przedyskutowane w kolejnym rozdziale. 

\subsection{Porównanie wydajności modeli predykcyjnych}
W tym podrozdziale poświęcona zostanie szczególna uwaga wynikom uzyskiwanym przez poszczególne modele, problemom występującym w procesie badawczym oraz zestawieniu wyników wszystkich metod. Oczekuje się, że opis wyników oraz ich analiza przedstawią wystarczający poziom dokładności pozwalający przenieść uwagę na wyciąganie wniosków.
 
\subsubsection{Regresja liniowa}
W procesie badania efektywności regresji liniowej do predykcji szeregu czasowego uzyskane zostały parametry opisujące poprawność predykcji oraz wizualne zestawienie wartości przewidywanych i realnych. W tej podsekcji zostaną one przedstawione oraz przedyskutowane. 

W pierwszej kolejności przedyskutowane zostaną uzyskane wartości parametrów opisujące poprawność wyników. Wyliczone zostały wartości:
\begin{center}
	\begin{itemize}
		\item wynik testu ($R^2$)
		\item błąd średniokwadratowy (MSE)
		\item pierwiastek błędu średniokwadratowego (RMSE)
		\item indeks Willmott'a
	\end{itemize}
\end{center}
, których wartości zostały przedstawione w \autoref{table:1}. Zostaną one wykorzystane w celu porównania jakości uzyskiwanych wyników z innymi metodami.
\begin{table}[h!]
	\centering
	\begin{tabular}{|c|c|c|c|}
		\hline
		$R^2$ & MSE & RMSE & Willmott \\
		0.3230 &1386.2897 & 37.2329 & 0.6719 \\
		\hline
	\end{tabular}
		\caption{Parametry opisujące poprawność wyników regresji liniowej}
		\label{table:1}
\end{table}

Na \autoref{figure:linear} przedstawione zostało zestawienie wyników uzyskanych przez regresję liniową z wynikami obserwacji. Wyniki będące rezultatem regresji są na rysunku zaznaczone kolorem pomarańczowym, a pierwotny szereg czasowy kolorem niebieskim. Na osi x znajdują się daty z przedziału [01.01.2000 - 31.12.2020], na osi y natomiast poziom stężenia pyłu PM10 w $\frac{\si{\micro\gram}}{\si\meter^3}$. 

Wykres ten pokazuje, że regresja metodą najmniejszych kwadratów dobrze przystosowała się do okresowości badanego szeregu. Dobrze przystosowała się zmian zanieczyszczenia w różnych porach roku. Wychwyciła również ogólny trend zmniejszającego się poziomu zanieczyszczeń w kolejnych latach. Możemy również zaobserwować, że regresja liniowa miała problem z przewidzeniem bardzo wysokich poziomów zanieczyszczeń w zimie. 

\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{linear.png}}
	\caption{Zestawienie wyników regresji liniowej z prawdziwymi obserwacjami}
	\label{figure:linear}
\end{figure}
\FloatBarrier
\subsubsection{Drzewa decyzyjne}
Podczas badania efektywności drzew decyzyjnych do predykcji szeregów czasowych stworzone zostały zostały parametry opisujące jakość wyników, zestawienie predykcji z danymi pomiarowymi oraz wizualizacja drzewa decyzyjnego. Stworzono również zestawienie jakości wyników predykcji w zależności od dozwolonej głębokości drzewa. 

W \autoref{table:2} przedstawione zostały wyniki parametrów opisujących jakość otrzymanych predykcji. Przedstawione w tabeli są:
\begin{center}
	\begin{itemize}
		\item wynik testu ($R^2$)
		\item błąd średniokwadratowy (MSE)
		\item pierwiastek błędu średniokwadratowego (RMSE)
		\item indeks Willmott'a
	\end{itemize}
\end{center}
Warto zauważyć, że o ile wartość indeksu Willmott'a utrzymuje się na podobnym poziomie to pozostałe parametry zmieniają się znacząco wraz ze wzrostem głębokości drzewa. Szczególnie interesującym wskaźnikiem jest wynik testu $R^2$, który spada w szybkim tempie i osiąga wartości ujemne. Zazwyczaj ujemne wartości tego testu oznaczają, że sposób predykcji nie jest odpowiedni dla danych wejściowych. Zmiana ta została zaprezentowana na \autoref{figure:treer2}, gdzie na osi X prezentowana jest głębokość drzewa, a na osi Y wynik testu $R^2$.

\begin{table}[h!]
	\centering
	\begin{tabular}{|c|c|c|c|c|}
		\hline
		Głębokość drzewa & $R^2$ & MSE & RMSE & Willmott \\
		3  & 0.3115 & 1409.9907 & 37.5498 & 0.6708 \\
		4  & 0.3276 & 1376.8134 & 37.1054 & 0.6878 \\
		5  & 0.2790 & 1476.4216 & 38.4242 & 0.6845 \\
		6  & 0.2527 & 1530.2719 & 39.1187 & 0.6850 \\
		7  & 0.2004 & 1637.5259 & 40.4664 & 0.6830 \\
		8  & 0.1274 & 1786.9854 & 42.2727 & 0.6723 \\
		9  & 0.0530 & 1939.2576 & 44.0370 & 0.6613 \\
		10 & -0.0039 & 2055.8442 & 45.3414 & 0.6448 \\
		11 & -0.1173 & 2288.0452 & 47.8335 & 0.6096 \\
		12 & -0.1333 & 2320.7656 & 48.1743 & 0.6122 \\
		13 & -0.1870 & 2430.7387 & 49.3025 & 0.6097 \\
		14 & -0.2812 & 2623.6710 & 51.2219 & 0.6017 \\
		\hline
	\end{tabular}
	\caption{Parametry opisujące poprawność wyników regresji liniowej}
	\label{table:2}
\end{table}
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.42]{trees_r2.png}}
	\caption{Zmiana wyniku testu $R^2$ dla różnych głębokości drzewa}
	\label{figure:treer2}
\end{figure}
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{decission_tree_5.png}}
	\caption{Zestawienie wyników drzewa o głębokości 5 z prawdziwymi obserwacjami}
	\label{figure:tree5}
\end{figure}
\FloatBarrier
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{decission_tree_14.png}}
	\caption{Zestawienie wyników drzewa o głębokości 14 z prawdziwymi obserwacjami}
	\label{figure:tree14}
\end{figure}
\FloatBarrier

Na \autoref{figure:tree5} i \autoref{figure:tree14} przedstawione są wyniki predykcji w zestawieniu z pierwotnymi obserwacjami w szeregu. Na \autoref{figure:tree5} z powodu ograniczonej wielkości drzewa, większość przypadków decyzyjnych znajduje się w przedziale (0 - 100) $\frac{\si{\micro\gram}}{\si\meter^3}$ co pozwala na relatywnie poprawne odwzorowanie zbioru danych. Natomiast na \autoref{figure:tree14} z powodu większej głębokości drzewa tworzone są przypadki decyzyjne dla bardzo odosobnionych, bardzo wysokich wartości zanieczyszczeń, które nie reprezentują większości danych wejściowych. 

Z tego powodu przyjęte zostało założenie wykorzystywania optymalnej głębokości drzewa w dalszej analizie porównawczej z innymi modelami. Nieuczciwy byłby wybór takiego drzewa decyzyjnego, w którym poprzez zbyt dużą głębokość drzewa wyniki predykcji nie odwzorowują adekwatnie danych wejściowych, jeżeli zmiana głębokości pozwala na otrzymanie wierniejszych oryginałowi predykcji.

Sporządzona została również wizualizacja procesu decyzyjnego dla drzewa o głębokości równej pięć pozwalająca lepiej zrozumieć działanie drzewa decyzyjnego. Jest ona przedstawiona na \autoref{figure:tree_graph} i pozwala zauważyć wyraźnie drzewiastą strukturę podejmowania decyzji. Nie jest niestety możliwe zawarcie tej ilustracji w wystarczająco dużym formacie, aby móc przyjrzeć się dokładnie poszczególnym liściom drzewa. Z tego powodu stworzona została również wizualizacja dla drzewa o głębokości równej 3 przedstawiona na \autoref{figure:tree_graph_small}
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.06]{decission_tree_tree.png}}
	\caption{Proces decyzyjny drzewa o głębokości równej 5}
	\label{figure:tree_graph}
\end{figure}
\FloatBarrier
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.25]{tree.png}}
	\caption{Proces decyzyjny drzewa o głębokości równej 3}
	\label{figure:tree_graph_small}
\end{figure}
\FloatBarrier
Taka wizualizacja pozwala na lepsze zrozumienie zbioru danych i znaczenia różnych parametrów klimatycznych obecnych w szeregu czasowym. Za pierwszy punkt podziału oba drzewa przyjmują fakt występowania przymrozku w danym dniu. Dalsza analiza pozwala zaobserwować inne ciekawe sytuacje bezpośrednio wpływające na poziom zanieczyszczeń. Na przykład zarówno w lewej jak i prawej części drzewa, fakt występowania opadu atmosferycznego implikuje zwiększony poziom zanieczyszczeń. 

\subsubsection{Prosta sieć rekurencyjna}
W ramach badania przydatności prostej sieci rekurencyjnej uzyskane zostały wartości parametrów opisujących jakość wyników modelu oraz graficzne reprezentacje rozwiązania dostarczanego przez model. Wyniki te zostaną przedstawione i przedyskutowane w ramach tej podsekcji.


W \autoref{table:simpleRNN} przedstawione zostały wyniki parametrów opisujących jakość otrzymanych predykcji. Przedstawione w tabeli są:
\begin{center}
	\begin{itemize}
		\item wynik testu ($R^2$)
		\item błąd średniokwadratowy (MSE)
		\item pierwiastek błędu średniokwadratowego (RMSE)
		\item indeks Willmott'a
	\end{itemize}
\end{center}

Korzystając z tych danych można zaobserwować, że wartości parametrów poprawiają się wraz ze wzrostem liczby neuronów. Takie zjawisko nie powinno być w żadnym wypadku zaskakujące, można spodziewać się, że większa sieć będzie lepiej przetwarzać dane wejściowe. Warto jednak zauważyć, że nie występuje liniowa zależność pomiędzy wzrostem ilości neuronów oraz dokładnością predykcji. Mając na uwadze ten fakt oraz znaczące zwiększenie się czasu trenowania większych sieci warto postarać się o znalezienie optymalnej liczby neuronów w warstwie ukrytej. Zależność ta została przedstawiona na \autoref{figure:simple_rnn_neurons}.

\begin{table}[h!]
	\centering
	\begin{tabular}{|c|c|c|c|c|}
		\hline
		Liczba neuronów w warstwie ukrytej & $R^2$ & MSE & RMSE & Willmott \\
		1    & -0.6348 & 3347.8974 & 57.8610 & 0.3961 \\
		2    & -0.3668 & 2798.9705 & 52.9053 & 0.3735 \\
		4    & -0.0525 & 2155.2926 & 46.4251 & 0.3050 \\
		8    & 0.1528  & 1734.8320 & 41.6513 & 0.4193 \\
		16   & 0.2446  & 1546.9749 & 39.3316 & 0.5749 \\
		32   & 0.3070  & 1418.9520 & 37.6690 & 0.6463 \\
		64   & 0.3484  & 1334.4482 & 36.5301 & 0.6896 \\
		128  & 0.3763  & 1277.3338 & 35.7398 & 0.7110 \\
		256  & 0.3865  & 1256.3483 & 35.4450 & 0.7190 \\
		512  & 0.3810  & 1267.6353 & 35.6038 & 0.7247 \\
		1024 & 0.3797  & 1270.2468 & 35.6405 & 0.6995 \\
		\hline
	\end{tabular}
	\caption{Parametry opisujące poprawność wyników predykcji prostej sieci neuronowej}
	\label{table:simpleRNN}
\end{table}
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.3]{simple_rnn_neurons.png}}
	\caption{Wynik testu $R^2$ dla różnej liczby neuronów w warstwie ukrytej}
	\label{figure:simple_rnn_neurons}
\end{figure}
\FloatBarrier
 \begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{simpleRNN_2.png}}
	\caption{Zestawienie wyników prostej rekurencyjnej sieci neuronowej z dwoma neuronami w warstwie ukrytej z prawdziwymi obserwacjami}
	\label{figure:simple_rnn_2}
\end{figure}
\FloatBarrier
 \begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{simpleRNN_64.png}}
	\caption{Zestawienie wyników prostej rekurencyjnej sieci neuronowej z 64 neuronami w warstwie ukrytej z prawdziwymi obserwacjami}
	\label{figure:simple_rnn_64}
\end{figure}
\FloatBarrier
 \begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{simpleRNN_512.png}}
	\caption{Zestawienie wyników prostej rekurencyjnej sieci neuronowej z 512 neuronami w warstwie ukrytej z prawdziwymi obserwacjami}
	\label{figure:simple_rnn_512}
\end{figure}
\FloatBarrier

Na \autoref{figure:simple_rnn_2} \autoref{figure:simple_rnn_64} \autoref{figure:simple_rnn_512} przedstawione zostały zestawienia wyników predykcji z danymi zgromadzonymi w pierwotnym szeregu czasowym. Bliższa analiza tych rysunków pozwoli lepiej zrozumieć wpływ liczby neuronów w warstwie ukrytej na jakość otrzymywanych predykcji. Na \autoref{figure:simple_rnn_2} można zaobserwować zachowanie sieci neuronowej, która nie posiada wystarczającej liczby neuronów. Model taki nie odwzorowuje poprawnie danych wejściowych, jest zdecydowanie zbyt prosty do przedstawiania jakkolwiek sensownych predykcji. 

Ciekawsze są dwa kolejne rysunki, dla 64 i 512 neuronów w warstwie ukrytej. Można zaobserwować, że te modele w odwzorowują dane wejściowe ze zdecydowanie wyższą precyzją. Warto zwrócić uwagę na fakt, że różnice pomiędzy tymi dwoma modelami nie są dramatyczne i na pewno nie proporcjonalne do różnicy w liczbie neuronów. Interesujący może być fakt, że przy zwiększeniu liczby neuronów sieć stara się bardziej dopasowywać do bardzo wysokich poziomów zanieczyszczeń. To zachowanie może implikować występowanie problemu zbytniego dopasowywania się do danych wejściowych, które było widoczne w zbyt głębokich drzewach decyzyjnych.

Ostatecznie warto zauważyć, że niezależnie od liczby neuronów w warstwie ukrytej sieci mają problem z wychwyceniem długotrwałego trendu zmniejszenia się poziomu zanieczyszczeń w kolejnych latach. Dobrze rozumieją one okresowość danych wejściowych, ale zdają się nie mieć wystarczającej liczby informacji do wychwycenia trendu. 

\subsubsection{Sieć rekurencyjna typu LSTM}
W ramach badania przydatności sieci rekurencyjnej opartej na architekturze Long Short-Term Memory zebrane zostały wyniki analogiczne jak przy badaniu prostej sieci rekurencyjnej. W tym podrozdziale zostaną one przedstawione, przedyskutowane oraz przeanalizowane w izolacji od innych metod predykcyjnych. 

W \autoref{table:lstm} przedstawione zostały wartości parametrów opisujących dokładność wyników predykcji w zależności od liczby neuronów w warstwie ukrytej. Są to takie same parametry jak w pozostałych metodach, więc nie zostaną one tutaj dokładniej przedstawione. Na podstawie danych w tabeli możemy zaobserwować wyraźną poprawę parametrów wraz ze wzrostem liczby neuronów w warstwie ukrytej. Relacja ta została zaprezentowana na \autoref{figure:lstm_neurons} i jest bardzo wyraźnie nie liniowa. 

\begin{table}[h!]
	\centering
	\begin{tabular}{|c|c|c|c|c|}
		\hline
		Liczba neuronów w warstwie ukrytej & $R^2$ & MSE & RMSE & Willmott \\
		1    & -0.6827 & 3445.6967 & 58.7001 & 0.3979 \\
		2    & -0.4874 & 3045.8948 & 55.1896 & 0.3871 \\
		4    & -0.1599 & 2375.2018 & 48.7360 & 0.3169 \\
		8    & 0.0965  & 1850.1311 & 43.0132 & 0.3006 \\
		16   & 0.2123  & 1613.1037 & 40.1635 & 0.5075 \\
		32   & 0.3041  & 1425.1676 & 37.7514 & 0.6350 \\
		64   & 0.3447  & 1341.8487 & 36.6313 & 0.6796 \\
		128  & 0.3766  & 1276.6038 & 35.7296 & 0.6992 \\
		256  & 0.3948  & 1239.2538 & 35.2030 & 0.7154 \\
		512  & 0.4057  & 1217.0582 & 34.8864 & 0.7341 \\
		1024 & 0.4053  & 1217.7866 & 34.8968 & 0.7479 \\
		\hline
	\end{tabular}
	\caption{Parametry opisujące poprawność wyników sieci LSTM}
	\label{table:lstm}
\end{table}
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.3]{lstm_neurons.png}}
	\caption{Wynik testu $R^2$ dla różnej liczby neuronów w warstwie ukrytej}
	\label{figure:lstm_neurons}
\end{figure}
\FloatBarrier
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{LSTM_2.png}}
	\caption{Zestawienie wyników sieci LSTM z dwoma neuronami w warstwie ukrytej z prawdziwymi obserwacjami}
	\label{figure:lstm_2}
\end{figure}
\FloatBarrier
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{LSTM_64.png}}
	\caption{Zestawienie wyników sieci LSTM z 64 neuronami w warstwie ukrytej z prawdziwymi obserwacjami}
	\label{figure:lstm_64}
\end{figure}
\FloatBarrier
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{LSTM_512.png}}
	\caption{Zestawienie wyników sieci LSTM z 512 neuronami w warstwie ukrytej z prawdziwymi obserwacjami}
	\label{figure:lstm_512}
\end{figure}
\FloatBarrier

Na \autoref{figure:lstm_2}, \autoref{figure:lstm_64} oraz \autoref{figure:lstm_512} przedstawione zostały zestawienia predykcji sieci neuronowej typu LSTM z danymi obserwacyjnymi. Prezentowany jest realny i przewidziany poziom zanieczyszczenia pyłem PM10 w perspektywie czasowej. Na osi x reprezentowany jest czas w dniach, a na osi y stężenie pyłu PM10 w  $\frac{\si{\micro\gram}}{\si\meter^3}$. Rysunki te odzwierciedlają dobitniej fenomen obserwowany w \autoref{table:lstm} stanowiąc użyteczny mechanizm do zrozumienia działania modelu. 

Wyraźnie wybrzmiewa całkowity brak dopasowania modelu z dwoma neuronami w warstwie ukrytej do danych wejściowych. Tak małej sieci neuronowej brakuje mocy do poprawnego przetworzenia informacji wejściowej i bardzo mocno generalizuje przez co całkowicie mija się z danymi wejściowymi. Brakuje jej również mocy obliczeniowej do przystosowania się do długofalowego trendu obecnego w danych. Taki model jest zdecydowanie nie adekwatny i nie powinien być wykorzystywany w dalszych analizach. 

Natomiast zarówno modele prezentowane na \autoref{figure:lstm_64} i \autoref{figure:lstm_512} w relatywnie poprawny sposób odtwarzają dane wejściowe. Model z 512 neuronami w warstwie ukrytej zdaje się generować dokładniejsze odtworzenie zbioru wejściowego. Jednak różnica ta nie wydaje się być radykalna i na pewno nie jest proporcjonalna do zmiany liczby neuronów. Obserwacja ta umacnia wnioski płynące z \autoref{figure:lstm_neurons}, że od pewnego momentu zmiana wielkości warstwy ukrytej zaczyna mieć niewielki wpływ na jakość uzyskiwanych wyników. 

Przykładem obrazującym większą dokładność predykcji większego modelu może być większa uwaga poświęcana bardzo wysokim poziomom zanieczyszczeń, które model z 64 neuronami w warstwie ukrytej co do zasady pomija w predykcjach. Taka próba dopasowywania do wszystkich wyników zbioru może prowadzić do niebezpieczeństw zbytniego dopasowywania do zbioru danych podobnego do zbyt głębokiego drzewa decyzyjnego.

Niestety niezależnie do liczności warstwy ukrytej wszystkie sieci mają problem z wychwyceniem ogólnego trendu zmniejszania się zanieczyszczeń. Zgodnie z założeniami architektury sieć typu Long Short-Term Memory powinna być w stanie poradzić sobie z takim zadaniem. Jednakowoż trend, którego nie potrafi zauważyć żadna z sieci jest naprawdę niewielki i może być niewystarczający dla sieci do odnotowania. 

Mając na uwadze te aspekty wpływu modelu na jakość wyników oraz zwiększony koszt obliczeniowy dla większych sieci neuronowych należy starać znaleźć optymalną wielkość sieci do predykcji danego szeregu. Aspektem do wzięcia pod uwagę podczas tego poszukiwania powinny być różnice w prędkości uczenia różnych sieci neuronowych.

\subsubsection{Sieć rekurencyjna typu GRU}
W ramach badania sieci Gated Recurrent Memory zebrane zostały dane analogiczne do tych dla innych analizowanych modeli predykcyjnych. W tym podrozdziale zostaną one przedstawione, omówione oraz przeanalizowane pod kątem wyboru optymalnych parametrów sieci do dalszej analizy. 

W \autoref{table:gru} przedstawione zostały wartości parametrów opisujące jakość wyników predykcji z wykorzystaniem sieci neuronowej w architekturze GRU. Są one ukazane w zależności od liczby neuronów w warstwie ukrytej. Prezentowane są dokładnie takie same parametry jak w innych metodach predykcyjnych. Dokładna analiza tych parametrów pozwoli na lepsze zrozumienie działania sieci opartej na architekturze Gated Recurrent Unit. 

Wyraźnie widoczna jest poprawa wartości parametrów wraz z wzrostem liczby neuronów w warstwie ukrytej. Zmiana ta nie jest jednak jednolita, istnieją nawet spadki wartości indeksu Willmott'a podczas wzrostu liczby neuronów. Zjawisko to jest najpewniej lokalną anomalią, aczkolwiek warto brać pod uwagę fakt, że zwiększenie warstwy ukrytej nie musi prowadzić do lepszego wyniku. 

Przyglądając się relacji wyniku testu $R^2$ do liczby neuronów w warstwie ukrytej dobitnie widoczna jest nieliniowość tej relacji. Została ona zaprezentowana na \autoref{figure:gru_neurons}, gdzie na osi x przedstawiana jest liczba neuronów, a na osi y wyniku testu $R^2$. Wyraźnie widoczny jest bardzo szybki początkowy wzrost wyniku testu przy niewielkim zwiększeniu wielkości warstwy ukrytej. To tempo wzrostu gwałtownie wyhamowuje w okolicy wartości 0.4 i pozostaje relatywnie stałe pomimo zwiększania liczby neuronów. Na tej podstawie można wywnioskować, że po osiągnięciu pewnego progu wzrost liczby neuronów w warstwie ukrytej nie poprawia jakości rozwiązania prezentowanego przez sieć neuronową. 

\begin{table}[h!]
	\centering
	\begin{tabular}{|c|c|c|c|c|}
		\hline
		Liczba neuronów w warstwie ukrytej & $R^2$ & MSE & RMSE & Willmott \\
		1    & -0.5998 & 3276.1793 & 57.2379 & 0.3945 \\
		2    & -0.3570 & 2778.8420 & 52.7147 & 0.3720 \\
		4    & -0.0395 & 2128.6287 & 46.1371 & 0.3058 \\
		8    & 0.1676  & 1704.5330 & 41.2860 & 0.4393 \\
		16   & 0.2692  & 1496.4748 & 38.6843 & 0.5966 \\
		32   & 0.3341  & 1363.7161 & 36.9285 & 0.6527 \\
		64   & 0.3751  & 1279.7501 & 35.7736 & 0.7068 \\
		128  & 0.3928  & 1243.4949 & 35.2632 & 0.7207 \\
		256  & 0.3987  & 1231.2979 & 35.0899 & 0.7053 \\
		512  & 0.4057  & 1216.9403 & 34.8847 & 0.7239 \\
		1024 & 0.4048  & 1218.8890 & 34.9126 & 0.7308 \\
		\hline
	\end{tabular}
	\caption{Parametry opisujące poprawność wyników sieci GRU}
	\label{table:gru}
\end{table}
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.3]{gru_neurons.png}}
	\caption{Wynik testu $R^2$ dla różnej liczby neuronów w warstwie ukrytej}
	\label{figure:gru_neurons}
\end{figure}
\FloatBarrier
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{GRU_2.png}}
	\caption{Zestawienie wyników sieci GRU z dwoma neuronami w warstwie ukrytej z prawdziwymi obserwacjami}
	\label{figure:gru_2}
\end{figure}
\FloatBarrier
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{GRU_64.png}}
	\caption{Zestawienie wyników sieci GRU z 64 neuronami w warstwie ukrytej z prawdziwymi obserwacjami}
	\label{figure:gru_64}
\end{figure}
\FloatBarrier
\begin{figure}[!ht]
	\centering
	\makebox[0pt]{\includegraphics[scale=0.4]{GRU_512.png}}
	\caption{Zestawienie wyników sieci GRU z 512 neuronami w warstwie ukrytej z prawdziwymi obserwacjami}
	\label{figure:gru_512}
\end{figure}
\FloatBarrier

Na \autoref{figure:gru_2}, \autoref{figure:gru_64} oraz \autoref{figure:gru_512} przedstawione zostały zestawienia wyników predykcji z realnymi danymi obserwacyjnymi. Na wykresach tych oś x reprezentuje czas w dniach, oś y natomiast reprezentuje poziom zanieczyszczenia pyłem PM10. Predykcje są zaznaczane kolorem pomarańczowym, a wartości obserwowane kolorem niebieskim. Dokładna analiza tych wykresów wraz ze zrozumieniem wcześniej omówionej \autoref{table:gru} z parametrami opisującym jakość wyników powinna umożliwić wybór optymalnej konfiguracji sieci neuronowej opartej o Gated Recurrent Unit.

Na \autoref{figure:gru_2} doskonale widać jak zachowuje się sieć nie posiadająca wystarczającej możliwości przetwarzania informacji w procesie predykcyjnym. Utworzone przez z nią predykcje zupełnie nie pokrywają się z danymi wejściowymi. Taki model jest przeciążony złożonością rozwiązywanego problemu i nie nadaje się w żadnym wypadku do zastosowania w tym konkretnym problemie. Nie ma najmniejszego sensu zajmować się tak prostym modelem w analizie biorąc jego całkowitą niemożność rozwiązania postawionego mu problemu. Być może tak mała warstwa ukryta będzie adekwatna w innych przypadkach, ale w tej pracy nie może zostać wykorzystana. Z obserwacji jej można jednak wyjąć ważne wnioski i należyte przedyskutowanie jej prowadzi do lepszego zrozumienia problemu. 

Zdecydowanie bardziej ciekawe w kontekście dalszej analizy są sieci neuronowe, których predykcje są obrazowane na \autoref{figure:gru_64} oraz \autoref{figure:gru_512}. Obie sieci ze znacznie większą dokładnością od poprzedniego odwzorowują zbiór wejściowy i zapewniają względnie akceptowalną jakość predykcji. Porównanie ich ze sobą może posłużyć jako podstawa do wyciągnięcia interesujących badawczo wniosków na temat sieci neuronowych w architekturze GRU. 

Wyraźnie widoczne jest podobieństwo obu wykresów, obserwacja ta znajduje również odzwierciedlenie w wynikach przedstawionych w \autoref{table:gru}. Odpowiada ono również charakterowi relacji pomiędzy dokładnością wyników a liczbę neuronów warstwy ukrytej prezentowany na \autoref{figure:gru_neurons}. Widoczna jest poprawa predykcji modelu z 1024 neuronami w warstwie ukrytej - poprawnie przewiduje on większą liczbę bardzo wysokich poziomów zanieczyszczeń, podchodzi do średnich wartości zanieczyszczeń z większym poziomem zniuansowania.

To podobieństwo może być również traktowane jako potencjalny problem biorąc pod uwagę wzrost złożoności obliczeniowej wraz ze wzrostem liczby neuronów. Jeżeli czterokrotny wzrost liczby neuronów nie daje proporcjonalnie lepszych wyników to warto zastanowić się czy takie dodatkowe skomplikowanie modelu ma jakikolwiek sens. Wydaje się być rozsądnym przedsięwzięciem próba odnalezienia optymalnej wielkości warstwy ukrytej dla rozwiązywanego problemu. 

Obserwując wszystkie trzy rysunki można stwierdzić fakt nie radzenia sobie sieci z odczytywaniem trendu w danych wejściowych. Znając architekturę sieci oraz założenia, na których została ona zbudowana, może być to zaskakujące. Trzeba jednak uczciwie stwierdzić, że trend ten jest naprawdę niewielkich rozmiarów co może znacząco utrudniać wykrycie go przez sieć. 

\subsubsection{Zestawienie otrzymanych wyników}
Kluczowym punktem tej pracy jest zestawienie ze sobą wyników różnych metod predykcyjnych i przeanalizowanie jakości zwracanych przez nie rozwiązań. Czynności te pozwolą zbudować podstawy do wyciągania wniosków odnośnie przydatności poszczególnych metod do predykcji szeregów czasowych. W tej podsekcji porównane ze sobą wyniki, które były dokładnie przedyskutowane w poprzednich podsekcjach oraz zbudowane zostaną podstawy merytoryczne do dalszej pracy i wyciągania wniosków. 
\subsection{Badanie skalowalności modelu GRU}

\section{Wnioski}

\printbibliography[title=Bibliografia]

\end{document}